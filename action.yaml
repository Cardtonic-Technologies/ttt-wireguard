name: TTT WireGuard
description: TTT WireGuard Connection Configuration

inputs:
  WG_CONFIG:
    required: false
    default: "${{ secrets.WG_CONFIG }}"
    description: TTT WireGuard (wg-quick) configuration secret file

runs:
  using: composite
  steps:
    - name: Set environment variables
      run: echo "MY_INPUT=${{ inputs.WG_CONFIG || secrets.WG_CONFIG }}" >>$GITHUB_ENV
      shell: bash

    - run: |
        sudo apt install resolvconf
        sudo apt install wireguard
        echo "${{ env.WG_CONFIG }}" >wg0.conf
        sudo chmod 600 wg0.conf
        sudo wg-quick up ./wg0.conf
      shell: bash

branding:
  icon: shield
  color: green